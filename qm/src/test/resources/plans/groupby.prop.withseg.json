{
  head : {
    type : "APACHE_DRILL_LOGICAL",
    version : 1,
    generator : {
      type : "AUTO",
      info : "sof-dsk"
    }
  },
  storage : { },
  query : [ {
    op : "scan",
    @id : 1,
    memo : "Scan(Table=sof-dsk.register_time)",
    storageengine : "mysql",
    selection : {
      projectoins : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      } ],
      table : "sof-dsk.register_time"
    },
    ref : "user"
  }, {
    op : "scan",
    @id : 2,
    memo : "Scan(Table=sof-dsk_deu)",
    storageengine : "hbase",
    selection : [ {
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      } ],
      filters : null,
      rowkey : {
        end : "20130101visit",
        start : "20130101visit"
      },
      table : "sof-dsk_deu"
    }, {
      projections : [ {
        ref : "uid",
        expr : "uid"
      }, {
        ref : "value",
        expr : "value"
      } ],
      filters : null,
      rowkey : {
        end : "20130102visit",
        start : "20130102visit"
      },
      table : "sof-dsk_deu"
    } ],
    ref : "event"
  }, {
    op : "scan",
    @id : 3,
    memo : "Scan(Table=sof-dsk.ref, Prop=ref, Val={EQ=wpc})",
    storageengine : "mysql",
    selection : {
      projectoins : [ {
        ref : "uid",
        expr : "uid"
      } ],
      filter : "val='wpc'",
      table : "sof-dsk.ref"
    },
    ref : "user"
  }, {
    op : "scan",
    @id : 4,
    memo : "Scan(Table=sof-dsk.register_time, Prop=register_time, Val={GTE=2010-01-01})",
    storageengine : "mysql",
    selection : {
      projectoins : [ {
        ref : "uid",
        expr : "uid"
      } ],
      filter : "val>='2010-01-01'",
      table : "sof-dsk.register_time"
    },
    ref : "user"
  }, {
    op : "join",
    @id : 5,
    left : 3,
    right : 4,
    conditions : [ {
      relationship : "==",
      left : "uid",
      right : "uid"
    } ],
    type : "INNER"
  }, {
    op : "join",
    @id : 6,
    left : 2,
    right : 5,
    conditions : [ {
      relationship : "==",
      left : "uid",
      right : "uid"
    } ],
    type : "INNER"
  }, {
    op : "join",
    @id : 7,
    left : 1,
    right : 6,
    conditions : [ {
      relationship : "==",
      left : "uid",
      right : "uid"
    } ],
    type : "RIGHT"
  }, {
    op : "segment",
    @id : 8,
    input : 7,
    exprs : [ {
      ref : "dimension",
      expr : "date(register_time)"
    } ],
    name : "sgmt"
  }, {
    op : "collapsingaggregate",
    @id : 9,
    input : 8,
    within : "sgmt",
    target : null,
    carryovers : [ "dimension" ],
    aggregations : [ {
      ref : "count",
      expr : "count(uid) "
    }, {
      ref : "user_num",
      expr : "count_distinct(uid) "
    }, {
      ref : "sum",
      expr : "sum(value) "
    } ]
  }, {
    op : "project",
    @id : 10,
    input : 9,
    projections : [ {
      ref : "query_id",
      expr : "'e1f86432-6173-4424-8066-f2d9d160f104'"
    }, {
      ref : "dimension",
      expr : "dimension"
    }, {
      ref : "count",
      expr : "count"
    }, {
      ref : "user_num",
      expr : "user_num"
    }, {
      ref : "sum",
      expr : "sum"
    } ]
  }, {
    op : "store",
    @id : 11,
    input : 10,
    target : null,
    partition : null,
    storageEngine : "mock"
  } ]
}